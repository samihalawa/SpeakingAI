<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LanguagAI - Plataforma de Aprendizaje de Espa√±ol</title>
  
  <!-- Dependencies -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@radix-ui/themes@2.0.0/styles.css">

  <!-- Custom CSS -->
  <style>
    /* Base Theme Variables */
    :root {
      --background: 0 0% 100%;
      --foreground: 222.2 84% 4.9%;
      --card: 0 0% 100%;
      --card-foreground: 222.2 84% 4.9%;
      --popover: 0 0% 100%;
      --popover-foreground: 222.2 84% 4.9%;
      --primary: 221.2 83.2% 53.3%;
      --primary-foreground: 210 40% 98%;
      --secondary: 210 40% 96.1%;
      --secondary-foreground: 222.2 47.4% 11.2%;
      --muted: 210 40% 96.1%;
      --muted-foreground: 215.4 16.3% 46.9%;
      --accent: 210 40% 96.1%;
      --accent-foreground: 222.2 47.4% 11.2%;
      --destructive: 0 84.2% 60.2%;
      --destructive-foreground: 210 40% 98%;
      --border: 214.3 31.8% 91.4%;
      --input: 214.3 31.8% 91.4%;
      --ring: 221.2 83.2% 53.3%;
      --radius: 0.5rem;
    }

    .dark {
      --background: 222.2 84% 4.9%;
      --foreground: 210 40% 98%;
      --card: 222.2 84% 4.9%;
      --card-foreground: 210 40% 98%;
      --popover: 222.2 84% 4.9%;
      --popover-foreground: 210 40% 98%;
      --primary: 217.2 91.2% 59.8%;
      --primary-foreground: 222.2 47.4% 11.2%;
      --secondary: 217.2 32.6% 17.5%;
      --secondary-foreground: 210 40% 98%;
      --muted: 217.2 32.6% 17.5%;
      --muted-foreground: 215 20.2% 65.1%;
      --accent: 217.2 32.6% 17.5%;
      --accent-foreground: 210 40% 98%;
      --destructive: 0 62.8% 30.6%;
      --destructive-foreground: 210 40% 98%;
      --border: 217.2 32.6% 17.5%;
      --input: 217.2 32.6% 17.5%;
      --ring: 224.3 76.3% 48%;
    }

    /* Base Styles */
    body {
      font-family: system-ui, -apple-system, sans-serif;
      background-color: hsl(var(--background));
      color: hsl(var(--foreground));
      margin: 0;
      min-height: 100vh;
    }

    /* Layout */
    .app-container {
      display: grid;
      grid-template-rows: auto 1fr;
      min-height: 100vh;
    }

    .main-content {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 1rem;
      padding: 1rem;
      height: calc(100vh - 4rem);
    }

    @media (max-width: 768px) {
      .main-content {
        grid-template-columns: 1fr;
      }
      
      .vocabulary-section {
        display: none;
      }
      
      .vocabulary-section.active {
        display: block;
        position: fixed;
        inset: 0;
        z-index: 50;
        background: hsl(var(--background));
      }
    }

    /* Components */
    .chat-section {
      display: flex;
      flex-direction: column;
      height: 100%;
      overflow: hidden;
    }

    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;
    }

    .message-input {
      padding: 1rem;
      border-top: 1px solid hsl(var(--border));
    }

    .message {
      margin-bottom: 1rem;
      padding: 1rem;
      border-radius: var(--radius);
      background: hsl(var(--card));
      border: 1px solid hsl(var(--border));
    }

    .message.user {
      margin-left: auto;
      background: hsl(var(--primary));
      color: hsl(var(--primary-foreground));
      max-width: 80%;
    }

    .message.ai {
      margin-right: auto;
      max-width: 80%;
    }

    /* Animations */
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .slide-in {
      animation: slideIn 0.2s ease-out;
    }

    /* Utilities */
    .hidden {
      display: none;
    }

    .flex {
      display: flex;
    }

    .flex-col {
      flex-direction: column;
    }

    .items-center {
      align-items: center;
    }

    .justify-between {
      justify-content: space-between;
    }

    .gap-2 {
      gap: 0.5rem;
    }

    /* Toast */
    .toast-container {
      position: fixed;
      top: 1rem;
      right: 1rem;
      z-index: 100;
    }

    .toast {
      padding: 1rem;
      border-radius: var(--radius);
      background: hsl(var(--background));
      border: 1px solid hsl(var(--border));
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      margin-bottom: 0.5rem;
      animation: slideIn 0.2s ease-out;
    }
  </style>
</head>
<body>
  <div id="app" class="app-container">
    <header class="flex items-center justify-between p-4 border-b border-[hsl(var(--border))]">
      <h1 class="text-xl font-bold">LanguagAI Espa√±ol</h1>
      <button @click="toggleTheme" class="p-2 rounded hover:bg-[hsl(var(--accent))]">
        {{ darkMode ? '‚òÄÔ∏è' : 'üåô' }}
      </button>
    </header>

    <main class="main-content">
      <section class="chat-section">
        <div class="chat-messages" ref="chatMessages">
          <template v-for="message in messages" :key="message.id">
            <div :class="['message slide-in', message.role]">
              <div class="message-content">{{ message.content }}</div>
              <div v-if="message.translation" class="message-translation text-sm text-[hsl(var(--muted-foreground))]">
                {{ message.translation }}
              </div>
              <div v-if="message.vocabulary?.length" class="vocabulary-highlights mt-2">
                <div v-for="word in message.vocabulary" :key="word.id" 
                     class="inline-block bg-[hsl(var(--accent))] rounded px-2 py-1 mr-2 mb-2 text-sm cursor-pointer"
                     @click="showWordDetails(word)">
                  {{ word.spanish }}
                </div>
              </div>
            </div>
          </template>
        </div>

        <div class="message-input">
          <form @submit.prevent="sendMessage" class="flex gap-2">
            <input v-model="userInput" 
                   type="text" 
                   placeholder="ËæìÂÖ•Ê∂àÊÅØ..." 
                   class="flex-1 px-3 py-2 rounded border border-[hsl(var(--input))] bg-transparent"
                   :disabled="loading">
            <button type="submit" 
                    class="px-4 py-2 rounded bg-[hsl(var(--primary))] text-[hsl(var(--primary-foreground))]"
                    :disabled="loading || !userInput.trim()">
              ÂèëÈÄÅ
            </button>
          </form>
        </div>
      </section>

      <section class="vocabulary-section" :class="{ active: showVocabulary }">
        <div class="flex items-center justify-between p-4 border-b border-[hsl(var(--border))]">
          <h2 class="text-lg font-semibold">ËØçÊ±áË°®</h2>
          <button @click="toggleVocabulary" class="md:hidden p-2">‚úï</button>
        </div>

        <div class="p-4">
          <input v-model="search" 
                 type="search" 
                 placeholder="ÊêúÁ¥¢ËØçÊ±á..." 
                 class="w-full px-3 py-2 rounded border border-[hsl(var(--input))] bg-transparent mb-4">

          <div class="vocabulary-list space-y-2">
            <div v-for="word in filteredVocabulary" 
                 :key="word.id" 
                 class="p-3 rounded border border-[hsl(var(--border))] hover:border-[hsl(var(--ring))] cursor-pointer"
                 @click="showWordDetails(word)">
              <div class="flex justify-between items-start">
                <div>
                  <div class="font-medium">{{ word.spanish }}</div>
                  <div class="text-sm text-[hsl(var(--muted-foreground))]">{{ word.chinese }}</div>
                </div>
                <div class="text-xs px-2 py-1 rounded bg-[hsl(var(--secondary))]">
                  {{ word.type }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Word Details Modal -->
    <div v-if="selectedWord" class="fixed inset-0 bg-black/50 flex items-center justify-center p-4">
      <div class="bg-[hsl(var(--background))] rounded-lg max-w-lg w-full p-6">
        <div class="flex justify-between items-start mb-4">
          <h3 class="text-lg font-semibold">{{ selectedWord.spanish }}</h3>
          <button @click="selectedWord = null" class="p-2">‚úï</button>
        </div>

        <div class="space-y-4">
          <div>
            <div class="text-sm text-[hsl(var(--muted-foreground))]">‰∏≠ÊñáÁøªËØë</div>
            <div>{{ selectedWord.chinese }}</div>
          </div>

          <div>
            <div class="text-sm text-[hsl(var(--muted-foreground))]">‰æãÂè•</div>
            <ul class="list-disc list-inside space-y-2">
              <li v-for="example in selectedWord.examples" :key="example">{{ example }}</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container">
      <div v-for="toast in toasts" :key="toast.id" class="toast">
        {{ toast.message }}
      </div>
    </div>
  </div>

  <script>
    const { createApp, ref, computed, onMounted, nextTick } = Vue;

    createApp({
      setup() {
        const messages = ref([]);
        const vocabulary = ref([]);
        const userInput = ref('');
        const loading = ref(false);
        const darkMode = ref(false);
        const showVocabulary = ref(false);
        const selectedWord = ref(null);
        const search = ref('');
        const toasts = ref([]);
        const chatMessages = ref(null);

        const filteredVocabulary = computed(() => {
          const searchTerm = search.value.toLowerCase();
          return vocabulary.value.filter(word => 
            word.spanish.toLowerCase().includes(searchTerm) ||
            word.chinese.toLowerCase().includes(searchTerm)
          );
        });

        function toggleTheme() {
          darkMode.value = !darkMode.value;
          document.documentElement.classList.toggle('dark', darkMode.value);
        }

        function toggleVocabulary() {
          showVocabulary.value = !showVocabulary.value;
        }

        function showWordDetails(word) {
          selectedWord.value = word;
        }

        function addToast(message) {
          const id = Date.now();
          toasts.value.push({ id, message });
          setTimeout(() => {
            toasts.value = toasts.value.filter(t => t.id !== id);
          }, 3000);
        }

        async function sendMessage() {
          if (!userInput.value.trim() || loading.value) return;

          const content = userInput.value;
          userInput.value = '';
          loading.value = true;

          try {
            const isChinese = /[\u4e00-\u9fff]/.test(content);
            const message = {
              id: Date.now(),
              role: 'user',
              content,
              translation: isChinese ? await translateText(content, 'zh', 'es') : await translateText(content, 'es', 'zh')
            };

            messages.value.push(message);
            await nextTick();
            scrollToBottom();

            // Simulate AI response
            setTimeout(async () => {
              const aiMessage = {
                id: Date.now(),
                role: 'ai',
                content: isChinese ? '¬°Hola! ¬øC√≥mo est√°s?' : '‰Ω†Â•ΩÔºÅÊúÄËøëÊÄé‰πàÊ†∑Ôºü',
                translation: isChinese ? '‰Ω†Â•ΩÔºÅ‰Ω†Â•ΩÂêóÔºü' : 'Hello! How are you?',
                vocabulary: [
                  {
                    id: Date.now(),
                    spanish: '¬øC√≥mo est√°s?',
                    chinese: '‰Ω†Â•ΩÂêóÔºü',
                    type: 'ÈóÆÂÄôËØ≠',
                    examples: [
                      '¬øC√≥mo est√°s hoy?',
                      '¬øC√≥mo est√° usted?'
                    ]
                  }
                ]
              };

              messages.value.push(aiMessage);
              aiMessage.vocabulary.forEach(word => {
                if (!vocabulary.value.some(v => v.spanish === word.spanish)) {
                  vocabulary.value.push(word);
                  addToast(`Êñ∞ËØçÊ±áÂ∑≤Ê∑ªÂä†Ôºö${word.spanish}`);
                }
              });

              await nextTick();
              scrollToBottom();
              loading.value = false;
            }, 1000);

          } catch (error) {
            console.error('Error sending message:', error);
            addToast('ÂèëÈÄÅÊ∂àÊÅØÊó∂Âá∫Èîô');
            loading.value = false;
          }
        }

        async function translateText(text, from, to) {
          // Simulate translation API call
          return new Promise(resolve => {
            setTimeout(() => {
              resolve(from === 'zh' ? '¬°Hola! ¬øC√≥mo est√°s?' : '‰Ω†Â•ΩÔºÅ‰Ω†Â•ΩÂêóÔºü');
            }, 500);
          });
        }

        function scrollToBottom() {
          if (chatMessages.value) {
            chatMessages.value.scrollTop = chatMessages.value.scrollHeight;
          }
        }

        onMounted(() => {
          // Check system theme preference
          if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            darkMode.value = true;
            document.documentElement.classList.add('dark');
          }
        });

        return {
          messages,
          vocabulary,
          userInput,
          loading,
          darkMode,
          showVocabulary,
          selectedWord,
          search,
          toasts,
          chatMessages,
          filteredVocabulary,
          toggleTheme,
          toggleVocabulary,
          showWordDetails,
          sendMessage
        };
      }
    }).mount('#app');
  </script>
</body>
</html>
